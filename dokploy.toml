# Dokploy Template for TelegramPloy
# Disaster Recovery System with S3 Monitoring & Telegram Delivery

[project]
name = "telegramploy"
description = "Monitor RustFS S3 buckets and send files to Telegram as disaster recovery"

[services.telegramploy]
type = "docker-compose"
path = "./docker-compose.yml"

# Environment variables that need to be configured
[[services.telegramploy.env]]
name = "DATABASE_PATH"
description = "Path to SQLite database file"
default = "/app/data/telegramploy.db"
required = true

[[services.telegramploy.env]]
name = "S3_ENDPOINT"
description = "RustFS S3 endpoint URL (e.g., https://s3.example.com)"
required = true

[[services.telegramploy.env]]
name = "S3_REGION"
description = "S3 region"
default = "us-east-1"
required = true

[[services.telegramploy.env]]
name = "S3_ACCESS_KEY_ID"
description = "S3 access key ID"
required = true
secret = true

[[services.telegramploy.env]]
name = "S3_SECRET_ACCESS_KEY"
description = "S3 secret access key"
required = true
secret = true

[[services.telegramploy.env]]
name = "S3_FORCE_PATH_STYLE"
description = "Use path-style S3 URLs (required for RustFS)"
default = "true"
required = true

[[services.telegramploy.env]]
name = "TELEGRAM_BOT_TOKEN"
description = "Telegram bot token from @BotFather"
required = true
secret = true

[[services.telegramploy.env]]
name = "TELEGRAM_CHAT_ID"
description = "Telegram chat ID to send files to"
required = true

[[services.telegramploy.env]]
name = "NEXTAUTH_URL"
description = "Full URL where the app will be deployed"
required = true

[[services.telegramploy.env]]
name = "NEXTAUTH_SECRET"
description = "Random secret for NextAuth (generate with: openssl rand -base64 32)"
required = true
secret = true

[[services.telegramploy.env]]
name = "POLL_INTERVAL_MS"
description = "Polling interval in milliseconds"
default = "60000"
required = false

[[services.telegramploy.env]]
name = "MAX_FILE_SIZE_MB"
description = "Maximum file size to process (MB)"
default = "2000"
required = false

[[services.telegramploy.env]]
name = "CHUNK_SIZE_MB"
description = "Chunk size for large files (MB)"
default = "50"
required = false

[volumes]
telegramploy-data = { driver = "local" }
